<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- vuetify CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vuetify@3.4.6/dist/vuetify.min.css">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet"/>
    <title>Faicon-Generator</title>
</head>
<body>
    
    <div style="margin: 0 60px; padding: 10% 0;" id="app"></div>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@3.4.6/dist/vuetify.min.js"></script>
    
        <script type="text/x-template" id="app-template">
            <v-app >
                <v-container >
                    <v-card variant="tonal">
                        <v-card class="innin-Card" variant="tonal">
                            <h3>Add Foto</h3>
                            <div class="FotoBackground" >
                                <img class="icon" v-if="selectedFileURL" :src="selectedFileURL" alt="Uploaded Image">
                            </div>
                            <!-- <v-input class="input" class="input" label="Image input"></v-input> -->
                        </v-card>
                            <!-- <v-label for="input-file" >add image</v-label> -->
                        <input type="file" class="input" @change="onFileSelected" id="input-file">
                        <input>
                            <hr style="width: 80%; margin: 0 auto;">
                                <div style="margin: 10px 90px" >
                                    <p>Selected Button: ({{ selectedOption.Width }}) x ({{ selectedOption.Height }})</p>
                                    <v-radio-group inline v-model="selectedOption">
                                        <v-radio v-for="imgOption in imgSizeOptions" :key="imgOption.id" :label="imgOption.name" :value="imgOption.value"></v-radio>
                                    </v-radio-group>
                                </div>
                            
                    </v-card>
                </v-container>
            </v-app>
        </script>

    <script>
        const {createApp, ref } = Vue
        const { createVuetify } = Vuetify

        const vuetify = createVuetify()
        const app = createApp({
            template: '#app-template',
            setup(){
                const selectedFileURL = ref(null)
                const imgSizeOptions  = ([
                    {
                        id: 1,
                        name: 'none',
                        value: {Width: 250, Height: 250},
                        safezone: false,
                        clicked: false
                    },
                    {
                        id: 2,
                        name: 'favicon.ico',
                        value: {Width: 32, Height: 32},
                        safezone: true,
                        clicked: false
                    },
                    {
                        id: 3,
                        name: 'Web-PNG',
                        value: {Width: 192, Height: 192},
                        safezone: true,
                        clicked: false
                    },
                    {
                        id: 4,
                        name: 'Apple-Touch ',
                        value: {Width: 180, Height: 180},
                        safezone: true,
                        clicked: false
                    },
                    {
                        id: 5,
                        name: 'Microsoft',
                        value: {Width: 150, Height: 150},
                        safezone: true,
                        
                        clicked: false
                    },
                    {
                        id: 6,
                        name: 'Safari Pinned ',
                        value: {Width: 'balck', Height: 'whgit'},
                        safezone: false,
                        clicked: false
                    },
                ])
                const WidthSize = 250
                const WidthHeight = 250

                console.log(WidthSize)
                console.log(WidthHeight)

                const selectedOption = ref(imgSizeOptions[0].value);

                const convertImageToSize = (selectedFile, widthSize, heightSize) => {
                    return new Promise((resolve) => {
                        const selFile = selectedFile;
                        if (!selFile) {
                        resolve('');
                        return;
                        }

                        const reader = new FileReader();
                        reader.onload = (e) => {
                        const img = new Image();
                        img.onload = () => {
                            const canvas = document.createElement('canvas');
                            const ctx = canvas.getContext('2d');
                            canvas.width = widthSize;
                            canvas.height = heightSize;
                            // Zeichne das Bild auf das Canvas und skaliere es auf die gewünschte Größe
                            ctx.drawImage(img, 0, 0, widthSize, heightSize);
                            // Konvertiere das Canvas-Bild zu Base64
                            const convertedImageURL = canvas.toDataURL('image/png'); // Du kannst auch 'image/png' verwenden
                            resolve(convertedImageURL);
                        };
                        img.src = e.target.result;
                        };
                        reader.readAsDataURL(selFile);
                    });
                }
            
                const onFileSelected = async (event) => {
                    const selectedFile = event.target.files[0];

                    if (selectedFile) {
                        // Bild in Base64 konvertieren
                        const reader = new FileReader();
                        reader.onload = async (e) => {
                            selectedFileURL.value = e.target.result;
                            console.log(selectedFileURL.value);

                            // Konvertiere das Bild in die gewünschte Größe
                            const convertedImageURL = await convertImageToSize(selectedFile, 250, 250);

                            // Verwende die konvertierte URL für das Bild im Canvas
                            selectedFileURL.value = convertedImageURL;
                        };
                        reader.readAsDataURL(selectedFile);
                    }
                };
                return {  imgSizeOptions, selectedOption, selectedFileURL, onFileSelected, convertImageToSize}
            }
        }).use(vuetify).mount('#app')
    </script> 
</body>
</html>

<style>
.innin-Card {
    position: relative;
    width: 450px;
    height: 400px;
    padding: 20px;
    margin: 20px auto;

}
.innin-Card h3 {
    text-align: center;
    padding: 0;
    margin: 0;
}
.FotoBackground {
    position: relative;
    width: 250px;
    height: 250px;
    background-color: aliceblue;
    margin: 30px 80px;

}
.FotoBackground .icon {
    position: absolute;
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.input {
    text-align: center;
    position: relative;
    margin: 10px 300px ;
}
.continer h3 {
    margin: 0 auto;
}
</style>
